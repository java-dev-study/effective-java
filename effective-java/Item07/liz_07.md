**Item 07 다 쓴 객체 참조를 해제하라**

다 쓴 객체 참조를 해제하지않으면 생기는 문제점 => 메모리 누수

메모리 누수를 방지하는 방법

1. 참조를 다 썼을때 null처리로 참조 해제

특히 자기 메모리를 직접 관리하는 클래스를 사용하는 경우 주의해야 한다.

(예시) Stack 클래스
Stack 클래스는 elements 배열로 저장소 풀을 만들어 원소들을 관리함
이 과정에서 배열의 활성 영역에 속한 원소들이 사용되고 비활성 영역은 쓰이지 않음
그러나 GC입장에서는 비활성 영역에서 참조되는 객체도 똑같이 유효한 객체로 판단함
=> 프로그래머가 직접 비활성 영역이 되는 순간 null처리를 해서 GC에게 알려줘야 함



2. 참조를 담은 변수를 유효 범위 밖으로 밀어냄

3. WeakHaspMap을 사용해 캐시를 만들자
객체 참조를 캐시넣고 한참동안 그냥 두면 메모리 누수를 일으킬 수 있음
WeekHashMap이 유용한 경우 => 캐시 외부에서 key를 참조하는 동안만 엔트리가 살아 있는 캐시가 필요한 상황

4. 쓰지 않는 캐시 엔트리 청소
- ScheduledTreadPoolExecutor같은 백그라운드 스레드 활용
- 캐시에 새 엔트리를 추가할 때 부수 작업으로 수행하는 방법 ex) LinkedHashMap removeEldestEntry메서드
- java.lang.ref 패키지 활용

5. 콜백을 약한 참조로 저장
클라이언트가 콜백을 등록만하고 명확히 해지하지 않으면 콜백이 계속 쌓여갈 것임.
이럴때 콜백을 약한 참조로 저장하면 GC가 즉시 수거해감 ex)WeakHashMap에 키로 저장

5. 철저한 코드 리뷰와 힙 프로파일러 같은 디버깅 도구 활용!!

